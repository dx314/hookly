import{d as Ae,a as d,f as l,s as f,c as Y}from"../chunks/DwoeUTs1.js";import{p as Ie,d as _,e as Z,o as Ne,u as Se,s as n,g as t,a as Fe,c as a,b as i,r,t as I,f as ee,h as Pe}from"../chunks/Dye_Vu_V.js";import{i as N}from"../chunks/B4UtDhsa.js";import{e as q,i as H}from"../chunks/oAOXQWqr.js";import{s as te}from"../chunks/Da0CPe4u.js";import{s as Re}from"../chunks/B-io2W3s.js";import{b as re}from"../chunks/BNJAlfjC.js";import{a as We,s as Te}from"../chunks/DOKCvP8A.js";import{p as Ve}from"../chunks/BcCpa0YI.js";import{W as v,e as ae}from"../chunks/i_25vcIR.js";var Be=l("<option> </option>"),Ge=l("<option> </option>"),ze=l('<div class="rounded-lg border border-[var(--color-border)] bg-[var(--color-background)]"><div class="p-8 text-center text-[var(--color-muted-foreground)]">Loading...</div></div>'),Ce=l('<div class="rounded-lg border border-[var(--color-destructive)] bg-[var(--color-destructive)]/10 p-4"><p class="text-[var(--color-destructive)]"> </p></div>'),Me=l('<div class="rounded-lg border border-[var(--color-border)] bg-[var(--color-background)] p-8 text-center"><p class="text-[var(--color-muted-foreground)]">No webhooks found.</p></div>'),Oe=l('<span class="text-green-600 text-sm">✓ Valid</span>'),Ue=l('<span class="text-[var(--color-muted-foreground)] text-sm">—</span>'),$e=l('<tr class="hover:bg-[var(--color-muted)]/50"><td class="px-4 py-3"><a class="text-sm font-medium text-[var(--color-foreground)] hover:underline"> </a></td><td class="px-4 py-3"><a class="text-sm text-[var(--color-muted-foreground)] hover:text-[var(--color-foreground)]"> </a></td><td class="px-4 py-3"><span> </span></td><td class="px-4 py-3 text-sm text-[var(--color-muted-foreground)]"> </td><td class="px-4 py-3"><!></td></tr>'),je=l('<div class="rounded-lg border border-[var(--color-border)] bg-[var(--color-background)] overflow-hidden"><table class="w-full"><thead class="bg-[var(--color-muted)]"><tr><th class="text-left px-4 py-3 text-sm font-medium text-[var(--color-muted-foreground)]">Received</th><th class="text-left px-4 py-3 text-sm font-medium text-[var(--color-muted-foreground)]">Endpoint</th><th class="text-left px-4 py-3 text-sm font-medium text-[var(--color-muted-foreground)]">Status</th><th class="text-left px-4 py-3 text-sm font-medium text-[var(--color-muted-foreground)]">Attempts</th><th class="text-left px-4 py-3 text-sm font-medium text-[var(--color-muted-foreground)]">Signature</th></tr></thead><tbody class="divide-y divide-[var(--color-border)]"></tbody></table></div>'),qe=l('<div class="space-y-6"><div><h1 class="text-2xl font-bold text-[var(--color-foreground)]">Webhooks</h1> <p class="text-[var(--color-muted-foreground)]">Browse and manage received webhooks</p></div> <div class="flex gap-4"><select class="px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-background)] text-[var(--color-foreground)] text-sm focus:outline-none focus:ring-2 focus:ring-[var(--color-ring)]"><option>All Endpoints</option><!></select> <select class="px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-background)] text-[var(--color-foreground)] text-sm focus:outline-none focus:ring-2 focus:ring-[var(--color-ring)]"></select></div> <!></div>');function at(oe,se){Ie(se,!0);const de=()=>Te(Ve,"$page",le),[le,ne]=We();let S=_(Z([])),F=_(Z([])),P=_(!0),D=_(null),k=_(void 0),R=_(void 0);const ie=[{value:void 0,label:"All Statuses"},{value:v.PENDING,label:"Pending"},{value:v.DELIVERED,label:"Delivered"},{value:v.FAILED,label:"Failed"},{value:v.DEAD_LETTER,label:"Dead Letter"}];Ne(async()=>{const e=de().url.searchParams.get("endpoint");e&&n(k,e,!0),await Promise.all([ce(),L()])}),Se(()=>{L()});async function ce(){try{const e=await ae.listEndpoints({});n(F,e.endpoints,!0)}catch(e){console.error("Failed to load endpoints:",e)}}async function L(){n(P,!0),n(D,null);try{const e=await ae.listWebhooks({endpointId:t(k),status:t(R),pagination:{pageSize:50}});n(S,e.webhooks,!0)}catch(e){n(D,e instanceof Error?e.message:"Failed to fetch webhooks",!0)}finally{n(P,!1)}}function ve(e){switch(e){case v.PENDING:return{class:"badge-pending",label:"Pending"};case v.DELIVERED:return{class:"badge-delivered",label:"Delivered"};case v.FAILED:return{class:"badge-failed",label:"Failed"};case v.DEAD_LETTER:return{class:"badge-dead-letter",label:"Dead Letter"};default:return{class:"",label:"Unknown"}}}function ue(e){return e?.seconds?new Date(Number(e.seconds)*1e3).toLocaleString():"N/A"}function pe(e){return t(F).find(o=>o.id===e)?.name??e}var W=qe(),T=i(a(W),2),b=a(T);b.__change=()=>L();var V=a(b);V.value=(V.__value=void 0)??"";var fe=i(V);q(fe,17,()=>t(F),H,(e,s)=>{var o=Be(),h=a(o,!0);r(o);var u={};I(()=>{f(h,t(s).name),u!==(u=t(s).id)&&(o.value=(o.__value=t(s).id)??"")}),d(e,o)}),r(b);var w=i(b,2);w.__change=()=>L(),q(w,21,()=>ie,H,(e,s)=>{var o=Ge(),h=a(o,!0);r(o);var u={};I(()=>{f(h,t(s).label),u!==(u=t(s).value)&&(o.value=(o.__value=t(s).value)??"")}),d(e,o)}),r(w),r(T);var me=i(T,2);{var ge=e=>{var s=ze();d(e,s)},xe=e=>{var s=Y(),o=ee(s);{var h=m=>{var g=Ce(),A=a(g),B=a(A,!0);r(A),r(g),I(()=>f(B,t(D))),d(m,g)},u=m=>{var g=Y(),A=ee(g);{var B=x=>{var y=Me();d(x,y)},_e=x=>{var y=je(),J=a(y),K=i(a(J));q(K,21,()=>t(S),H,(be,p)=>{const Q=Pe(()=>ve(t(p).status));var G=$e(),z=a(G),C=a(z),he=a(C,!0);r(C),r(z);var M=i(z),O=a(M),ye=a(O,!0);r(O),r(M);var U=i(M),$=a(U),Ee=a($,!0);r($),r(U);var j=i(U),De=a(j,!0);r(j);var X=i(j),ke=a(X);{var Le=c=>{var E=Oe();d(c,E)},we=c=>{var E=Ue();d(c,E)};N(ke,c=>{t(p).signatureValid?c(Le):c(we,!1)})}r(X),r(G),I((c,E)=>{te(C,"href",`/webhooks/${t(p).id??""}`),f(he,c),te(O,"href",`/endpoints/${t(p).endpointId??""}`),f(ye,E),Re($,1,`${t(Q).class??""} inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium`),f(Ee,t(Q).label),f(De,t(p).attempts)},[()=>ue(t(p).receivedAt),()=>pe(t(p).endpointId)]),d(be,G)}),r(K),r(J),r(y),d(x,y)};N(A,x=>{t(S).length===0?x(B):x(_e,!1)},!0)}d(m,g)};N(o,m=>{t(D)?m(h):m(u,!1)},!0)}d(e,s)};N(me,e=>{t(P)?e(ge):e(xe,!1)})}r(W),re(b,()=>t(k),e=>n(k,e)),re(w,()=>t(R),e=>n(R,e)),d(oe,W),Fe(),ne()}Ae(["change"]);export{at as component};
